 [![Creative Commons License BY-SA 4.0 International](https://i.creativecommons.org/l/by-sa/4.0/80x15.png)](../LICENSE_OUTLINE.md "プラグインのライセンスについて")

# Qithub のプラグインについて

Qithub （以下本体スクリプト）はプラグイン機能を持っています。これは Qiita ユーザーのコラボレーションの１つとして**プログラム言語に依存しないで Qithub で遊ぶために用意されたもの**で、GitHub アカウントを持っている **Qiita ユーザーなら誰でも参加できます**。

**プラグイン自体は単体で動作完結するシンプルなもの**ですが、本体スクリプトはプラグインなどを組み合わせて複雑な処理（「process」と呼ばれる複合処理）を行い BOT として機能します。

## どんなプラグインを作ればいいの？

**[禁止事項](#禁止事項)に触れなければ特に設けていません**。[[禁止事項をみる](#禁止事項)]

先を越されていなければ「Hello world」を返すだけのようなプラグインでも大丈夫です。先を越されていた場合は、そのプラグインを整備（コメント付け、誤字修正、リファクタリング）したり、機能を拡張したり、同じ機能を別言語で実装してみるなど、色々チャレンジしてみて遊んでください。

また、issue #14 の「[機能拡張 なくてもいいけど、あるとよりよい機能は？](https://github.com/Qithub-BOT/items/issues/14)」を参考にしたり、そこでアイデアを募ってもいいかもしれません。


## プラグインの基本概要

プラグインは単体で実行できるプログラム（スクリプト）です。しかし、プラグインが直接実行されることはなく、**本体スクリプトがコマンドラインを通してプラグインを実行**（リクエスト）します。

呼び出された**プラグインは標準入力よりデータを受け取り、処理結果を標準出力**します。（「レスポンス」）
本体スクリプトは、その実行結果を受け取って様々な用途に利用します。

この間の、本体スクリプトとプラグインの**データの送受信は全てJSONデータをURLエンコードした1つの文字列**で行われます。

### プラグインの仕様

- プログラム言語
    - サーバーが対応している CLI で動作する言語であれば**開発言語は問いません**
    - 現在の Qithub が稼働しているサーバーで動作確認済みのプログラム言語
       - PHP 7.0.22（CLI）

- プラグインの命名ルール（ディレクトリ名）
    - [DO]-[WHAT]-[WHERE] の順でお願いします。
        - 例）"say-hello", "roll-dice", "get-link-text", "search-string-wikipedia"

- プラグイン本体のスクリプト名
    - 呼び出されるプラグイン本体は "main.xxx" であること（xxxはプログラム言語ごとの拡張子）
    - プラグイン本体以外のスクリプト名には特にルールはありませんが、プラグイン・ディレクトリ内での方言や記述ルールは統一するようにしてください

- 設置先
    - `scripts/plugins/<プラグイン名>/main.xxx`

    - 必須ファイル（プラグイン・ディレクトリに設置するファイル）
        - `main.xxx` ：プラグイン本体
        - `index.html`：ブランク・ファイル

    - オプション・ファイル（あるといいもの）
        - `README.md`：プラグインの使い方や仕様などを記載します。（プラグイン本体に明記されていれば不要）
        - `.gitignore`：プラグインがファイルやデータを作成・保存する場合、それらデータをリポジトリに同期しないように設置します。


## 注意事項

### 「Side CI」のチェックがあります

作成したプラグインを Qithub-BOT/scripts リポジトリにプルリクエスト（以下 PR）すると SideCI によるコードレビューが自動的に行われますので、最低限このチェックをパスする必要があります。

### 書いたスクリプトは修正されます

Qithub-BOT/scripts に Push された、ブランチ／PR／コミットは**コードレビューを通った早いもの勝ち**でマージされます。また、自身が PR したブランチに他のユーザーがコミットすることもあります。

### ブランチは削除されます

## 禁止事項

- 遊びではなく**イタズラや悪意のある目的の実装**は禁止
- 自身のプラグイン・**ディレクトリより外へのファイル作成**は禁止
- 自身のプラグイン・**ディレクトリより外へのデータ・アクセス**は禁止（Web APIなどへのアクセスを除く）
- パスワードやアクセストークンなどの**非公開情報をハードコーディングしないと動作しない**実装は禁止
- **アクセストークンなどを使う処理**は禁止（※1）
- Qithub のライセンス（CC BY-SA）とは**違うライセンスのスクリプトを含める**ことは禁止（※2）
- Qiita / Qiitadon 含む、**他のサービスやユーザーに迷惑をかける**ことが明確な実装は禁止

※1）トゥートや Qiita記事の投稿など **特定ユーザーのアカウントで操作が必要なもの**。これらの操作が必要な機能を作りたい場合は`plugins`でなく`system`ディレクトリに設置する必要がありますが、その場合は、まず issue をたてて相談してください。

※2）プラグインの実行時に自身のプラグイン・**ディレクトリにダウンロードして利用する場合はこの限りではありません**が、ダウンロード先のスクリプトが安全かつそれを許可しているものに限ります。
